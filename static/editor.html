<!-- comentario para atualização git -->
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Semântico - ResumeFull.AI</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jodit@3.24.5/build/jodit.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jodit@3.24.5/build/jodit.min.js"></script>
    <!-- Idioma Pt-BR para Jodit -->
    <script src="https://cdn.jsdelivr.net/npm/jodit@3.24.5/build/langs/pt_br.js" crossorigin="anonymous"></script>
    
    <!-- Fonte Noto Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/editor.css">
</head>

<body>
    <div class="container">
        <!-- Painel Lateral - Imagens -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Galeria</h2>
                <button id="sidebarToggle" class="sidebar-toggle" aria-label="Retrair Galeria" title="Retrair Galeria">
    <img src="../images/close_small.svg" alt="Retrair Galeria" width="56" height="56" style="transform: rotate(180deg);" />
</button>
            </div>
            <div id="sidebarLogoCollapsed" class="sidebar-logo-collapsed" aria-hidden="true">
                <img src="../images/Logo_Favicon_ResumoFull.svg" alt="Logo ResumeFull" class="sidebar-logo-icon" title="resumofull.com.br" />
                <div class="sidebar-version-label" aria-hidden="true">Versão: 1.0</div>
            </div>
            <div id="galleryLoading" class="pdf-loading">
                <div class="pdf-loading-spinner"></div>
                <p>Carregando Galeria de Imagens...</p>
            </div>
            <div id="galleryContent" style="display: none;">
                <div class="gallery-source" aria-live="polite">
                    <img src="../images/icon_pdf_name_gallery.svg" alt="Ícone PDF" class="gallery-source-icon" />
                    <strong id="currentPdfLabel">Nenhum PDF encontrado</strong>
                </div>
                <!-- Toggle Switch de Galeria -->
                <div class="gallery-switch" id="gallerySwitchBar">
                    <select id="gallerySelect" class="gallery-select" title="Selecionar sessão da galeria" aria-label="Selecionar sessão da galeria">
                        <option value="pdf">Imagens Pré-Carregadas</option>
                        <option value="captures">Capturas de Tela Salvas</option>
                        <option value="uploads">Imagens Enviadas (uploads)</option>
                    </select>
                </div>
                <div id="uploadsControls" class="uploads-controls" style="display:none;">
                    <button id="btnUploadImages" class="btn btn-secondary" title="Enviar imagens" aria-label="Enviar imagens">
                        <img src="../images/upload_image.svg" alt="Enviar imagens" class="btn-icon-24" />
                        <span>Enviar Imagens</span>
                    </button>
                    <input id="inpUploadImages" type="file" accept="image/*" multiple style="display:none;" />
                </div>
                <div class="info-message" id="galleryInfoMessage">
                    <h3 id="imageCountInfo">Identifiquei 0 imagens vetoriais no PDF</h3>
                    <button class="info-close" id="galleryInfoClose" title="Fechar" aria-label="Fechar">×</button>
                </div>
                <div id="galleryEmptyState" style="display:none;">
                    <div class="gallery-empty-message">
                        Você não tem mais imagens do PDF na galeria. Capture novas imagens usando o painel de captura ou clique no botão abaixo para recapturar automaticamente as imagens iniciais do PDF.
                    </div>
                    <div class="gallery-empty-controls">
                        <button class="btn btn-secondary" id="btnRecoverInitialImages" title="Recuperar imagens iniciais do PDF" aria-label="Recuperar imagens iniciais do PDF">
                            <img src="../images/recovery_images_pdf.svg" alt="Recuperar imagens iniciais do PDF" class="btn-icon-24" />
                            <span>Recuperar imagens do PDF</span>
                        </button>
                        <button class="btn btn-secondary" id="btnRecoverCaptures" title="Capturar Imagem no PDF" aria-label="Capturar Imagem no PDF" style="display:none;">
                            <img src="../images/view_pdf.svg" alt="Capturar Imagem no PDF" class="btn-icon-24" />
                            <span>Capturar Imagem no PDF</span>
                        </button>
                    </div>
                </div>
                <div class="image-gallery" id="imageGallery">
                    <!-- Imagens serão carregadas dinamicamente -->
                </div>
                <div class="gallery-actions">
                    <button class="btn btn-danger delete-all-btn" onclick="deleteAllGalleryImages()" title="Excluir todas as imagens" aria-label="Excluir todas as imagens">
                        <img src="../images/delete_all_items.svg" alt="Excluir todas" class="btn-icon-24" />
                        <span>Excluir Todas as Imagens</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Área Principal -->
        <div class="main-editor">
                <button id="goToTopBtn" class="go-to-top-btn" title="Ir para o topo" aria-label="Ir para o topo">
                    <img src="../images/go_to_top.svg" alt="Ir para o topo" />
                </button>
            <div class="editor-header">
                <div class="editor-tabs">
                    <button id="tabEditor" class="btn btn-secondary tab-btn active">
                        <img src="../images/editor_resumo.svg" alt="Editor" class="btn-icon" />
                        Editor
                    </button>
                    <button id="btnCapture" class="btn btn-secondary tab-btn">
                        <img src="../images/view_pdf.svg" alt="Ver PDF" class="btn-icon" />
                        Capturar Imagem no PDF
                    </button>
                    <button id="upload_file" class="btn btn-secondary tab-btn">
                        <img src="../images/upload_file.svg" alt="Carregar PDF" class="btn-icon" />
                        Novo PDF
                    </button>
                </div>
                <div class="editor-actions">
                    <button id="btnSavedStates" class="btn btn-secondary" title="Projetos Salvos" aria-label="Projetos Salvos">
                        <img src="../images/folder_projects.svg" alt="Projetos Salvos" class="btn-icon" />
                        Projetos Salvos
                    </button>
                    <button id="btnSaveProjectState" class="btn btn-primary" title="Salvar Projeto" aria-label="Salvar Projeto">
                        <img src="../images/save_project.svg" alt="Salvar Projeto" class="btn-icon" />
                        Salvar Projeto
                    </button>
                </div>
            </div>

            <div class="content-area">
                <!-- Painel de Texto -->
                <div class="text-panel">
                    <div id="editorSection" class="editor-section" style="margin-top: 0;">
                        
                        <div id="structuredSummary" class="formatted-summary">
                            <div class="drop-zone">Solte a imagem aqui para inserir</div>
                            <!-- Conteúdo do resumo será carregado aqui -->
                        </div>
                    </div>
                    <div id="pdfCaptureSection" class="pdf-capture-section" style="display: none;">
                         <div id="pdfViewerToolbar" class="pdf-viewer-toolbar">
                             <div class="toolbar-left">
                                 <span id="adobeToolbarTitle">Visualizador Adobe PDF</span>
                             </div>
                             <div class="toolbar-right">
                                 <span id="adobeToolbarInfo"></span>
                                 <button id="btnCaptureImage" class="btn btn-secondary tab-btn" title="Capturar imagem" aria-label="Capturar imagem">
                                     <img src="../images/screen_capture.svg" alt="Capturar imagem" class="btn-icon-small" />
                                     <span>CAPTURAR IMAGEM</span>
                                 </button>
                                 <button id="btnFullscreen" class="btn btn-secondary tab-btn" title="Modo tela cheia" aria-label="Modo tela cheia">
                                     <img src="../images/open_in_full.svg" alt="Modo tela cheia" class="btn-icon-small" />
                                     <span>OCULTAR MENU</span>
                                 </button>
                             </div>
                         </div>
                         <div id="pdfCaptureContainer" class="pdf-capture-container">
                            <div id="adobe-dc-view" style="height: 1255px; width: 100%;"></div>
                            <script src="https://acrobatservices.adobe.com/view-sdk/viewer.js"></script>
                         </div>
                     </div>
                </div>

            </div>

            <div class="status-bar">
                <div class="status-info">
                    <span>Imagens posicionadas: <span id="imageCount">0</span></span>
                </div>
            </div>
        </div>
    </div>

    <div id="imageModal" class="modal-overlay" onclick="closeImageModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeImageModal()" title="Fechar" aria-label="Fechar">X</button>
            <div id="modalFilename" class="modal-filename"></div>
             <div class="modal-image-wrapper">
                 <img id="modalImage" class="modal-image" src="" alt="">
             </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="prevModalImage()">◀ Anterior</button>
                <button class="btn btn-secondary" onclick="nextModalImage()">Próxima ▶</button>
                <button class="btn btn-danger" onclick="deleteCurrentModalImage()">
                    <img src="../images/delete_all_items.svg" alt="Excluir" class="btn-icon-modal" />
                    <span>Excluir da galeria</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Salvar Projeto -->
    <div id="projectSaveModal" class="modal-overlay" onclick="closeProjectSaveModal()">
        <div class="modal-content" onclick="event.stopPropagation()" style="background: #FFFFFF;">
            <button class="modal-close" onclick="closeProjectSaveModal()" title="Fechar" aria-label="Fechar" style="padding: 4px 8px;">X</button>
            <h3 style="margin-bottom:10px">Salvar Projeto</h3>
            <input id="projectNameInput" type="text" placeholder="Nome do projeto" style="width: 500px; padding: 10px; border-radius: 6px; border: 1px solid #8d9092; margin: 10px 0;" />
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeProjectSaveModal()" style="padding: 4px 8px;">
                    <img src="/images/close.svg" alt="Cancelar" class="btn-icon-modal" />
                    Cancelar
                </button>
                <button class="btn btn-primary" id="confirmSaveProjectBtn" style="padding: 4px 8px;">
                    <img src="/images/save_project.svg" alt="Salvar" class="btn-icon-modal" />
                    Salvar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Projetos Salvos -->
    <div id="savedStatesModal" class="modal-overlay" onclick="closeSavedStatesModal()">
        <div class="modal-content" onclick="event.stopPropagation()" style="background: #FFFFFF;">
            <button class="modal-close" onclick="closeSavedStatesModal()" title="Fechar" aria-label="Fechar" style="padding: 4px 8px;">X</button>
            <h3 style="margin-bottom:10px">Meus Projetos Salvos</h3>
            <div id="savedStatesList" style="width: 100%;"></div>
        </div>
    </div>

    <!-- Modal: Sucesso -->
    <div id="successModal" class="modal-overlay" onclick="closeSuccessModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeSuccessModal()" title="Fechar" aria-label="Fechar">X</button>
            <div id="successMessage" style="margin: 10px 0;">Operação concluída com sucesso.</div>
        </div>
    </div>
    <script type="module" src="/static/js/editor/main.js?v=8"></script>
</body>

</html>

